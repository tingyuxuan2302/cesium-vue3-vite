var u=52.35987755982988,l=3.141592653589793,M=6378245,p=.006693421622965943,I=class{static BD09ToGCJ02(t,e){let i=+t-.0065,s=+e-.006,a=Math.sqrt(i*i+s*s)-2e-5*Math.sin(s*u),o=Math.atan2(s,i)-3e-6*Math.cos(i*u),r=a*Math.cos(o),n=a*Math.sin(o);return[r,n]}static GCJ02ToBD09(t,e){e=+e,t=+t;let i=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*u),s=Math.atan2(e,t)+3e-6*Math.cos(t*u),a=i*Math.cos(s)+.0065,o=i*Math.sin(s)+.006;return[a,o]}static WGS84ToGCJ02(t,e){if(e=+e,t=+t,this.out_of_china(t,e))return[t,e];{let i=this.delta(t,e);return[t+i[0],e+i[1]]}}static GCJ02ToWGS84(t,e){if(e=+e,t=+t,this.out_of_china(t,e))return[t,e];{let i=this.delta(t,e),s=t+i[0],a=e+i[1];return[t*2-s,e*2-a]}}static delta(t,e){let i=this.transformLng(t-105,e-35),s=this.transformLat(t-105,e-35),a=e/180*l,o=Math.sin(a);o=1-p*o*o;let r=Math.sqrt(o);return i=i*180/(M/r*Math.cos(a)*l),s=s*180/(M*(1-p)/(o*r)*l),[i,s]}static transformLng(t,e){e=+e,t=+t;let i=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return i+=(20*Math.sin(6*t*l)+20*Math.sin(2*t*l))*2/3,i+=(20*Math.sin(t*l)+40*Math.sin(t/3*l))*2/3,i+=(150*Math.sin(t/12*l)+300*Math.sin(t/30*l))*2/3,i}static transformLat(t,e){e=+e,t=+t;let i=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return i+=(20*Math.sin(6*t*l)+20*Math.sin(2*t*l))*2/3,i+=(20*Math.sin(e*l)+40*Math.sin(e/3*l))*2/3,i+=(160*Math.sin(e/12*l)+320*Math.sin(e*l/30))*2/3,i}static out_of_china(t,e){return e=+e,t=+t,!(t>73.66&&t<135.05&&e>3.86&&e<53.55)}},h=I,G=class extends Cesium.WebMercatorTilingScheme{constructor(t){super(t);let e=new Cesium.WebMercatorProjection;this._projection.project=function(i,s){return s=h.WGS84ToGCJ02(Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(i.latitude)),s=e.project(new Cesium.Cartographic(Cesium.Math.toRadians(s[0]),Cesium.Math.toRadians(s[1]))),new Cesium.Cartesian2(s.x,s.y)},this._projection.unproject=function(i,s){let a=e.unproject(i);return s=h.GCJ02ToWGS84(Cesium.Math.toDegrees(a.longitude),Cesium.Math.toDegrees(a.latitude)),new Cesium.Cartographic(Cesium.Math.toRadians(s[0]),Cesium.Math.toRadians(s[1]))}}},d=G,f={img:"//webst{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",elec:"//webrd{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",cva:"//webst{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}"},P=class extends Cesium.UrlTemplateImageryProvider{constructor(t={}){t.url=t.url||[t.protocol||"",f[t.style]||f.elec].join(""),(!t.subdomains||!t.subdomains.length)&&(t.subdomains=["01","02","03","04"]),t.crs==="WGS84"&&(t.tilingScheme=new d),super(t)}},m=P,j=637099681e-2,y=[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],g=[75,60,45,30,15,0],D=[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],C=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],O=class{constructor(){this.isWgs84=!1}getDistanceByMC(t,e){if(!t||!e||(t=this.convertMC2LL(t),!t))return 0;let i=this.toRadians(t.lng),s=this.toRadians(t.lat);if(e=this.convertMC2LL(e),!e)return 0;let a=this.toRadians(e.lng),o=this.toRadians(e.lat);return this.getDistance(i,a,s,o)}getDistanceByLL(t,e){if(!t||!e)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74);let i=this.toRadians(t.lng),s=this.toRadians(t.lat),a=this.toRadians(e.lng),o=this.toRadians(e.lat);return this.getDistance(i,a,s,o)}convertMC2LL(t){if(!t)return{lng:0,lat:0};let e={};if(this.isWgs84){e.lng=t.lng/2003750834e-2*180;let a=t.lat/2003750834e-2*180;return e.lat=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),{lng:e.lng.toFixed(6),lat:e.lat.toFixed(6)}}let i={lng:Math.abs(t.lng),lat:Math.abs(t.lat)},s;for(let a=0;a<y.length;a++)if(i.lat>=y[a]){s=D[a];break}return e=this.convertor(t,s),{lng:e.lng.toFixed(6),lat:e.lat.toFixed(6)}}convertLL2MC(t){if(!t)return{lng:0,lat:0};if(t.lng>180||t.lng<-180||t.lat>90||t.lat<-90)return t;if(this.isWgs84){let a={},o=6378137;a.lng=t.lng*Math.PI/180*o;let r=t.lat*Math.PI/180;return a.lat=o/2*Math.log((1+Math.sin(r))/(1-Math.sin(r))),{lng:parseFloat(a.lng.toFixed(2)),lat:parseFloat(a.lat.toFixed(2))}}t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74);let e={lng:t.lng,lat:t.lat},i;for(let a=0;a<g.length;a++)if(e.lat>=g[a]){i=C[a];break}if(!i){for(let a=0;a<g.length;a++)if(e.lat<=-g[a]){i=C[a];break}}let s=this.convertor(t,i);return{lng:parseFloat(s.lng.toFixed(2)),lat:parseFloat(s.lat.toFixed(2))}}convertor(t,e){if(!t||!e)return{lng:0,lat:0};let i=e[0]+e[1]*Math.abs(t.lng),s=Math.abs(t.lat)/e[9],a=e[2]+e[3]*s+e[4]*s*s+e[5]*s*s*s+e[6]*s*s*s*s+e[7]*s*s*s*s*s+e[8]*s*s*s*s*s*s;return i*=t.lng<0?-1:1,a*=t.lat<0?-1:1,{lng:i,lat:a}}getDistance(t,e,i,s){return j*Math.acos(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(e-t))}toRadians(t){return Math.PI*t/180}toDegrees(t){return 180*t/Math.PI}getRange(t,e,i){return e!=null&&(t=Math.max(t,e)),i!=null&&(t=Math.min(t,i)),t}getLoop(t,e,i){for(;t>i;)t-=i-e;for(;t<e;)t+=i-e;return t}lngLatToMercator(t){return this.convertLL2MC(t)}lngLatToPoint(t){let e=this.convertLL2MC(t);return{x:e.lng,y:e.lat}}mercatorToLngLat(t){return this.convertMC2LL(t)}pointToLngLat(t){let e={lng:t.x,lat:t.y};return this.convertMC2LL(e)}pointToPixel(t,e,i,s){if(!t)return;t=this.lngLatToMercator(t);let a=this.getZoomUnits(e),o=Math.round((t.lng-i.lng)/a+s.width/2),r=Math.round((i.lat-t.lat)/a+s.height/2);return{x:o,y:r}}pixelToPoint(t,e,i,s){if(!t)return;let a=this.getZoomUnits(e),o=i.lng+a*(t.x-s.width/2),r=i.lat-a*(t.y-s.height/2),n={lng:o,lat:r};return this.mercatorToLngLat(n)}getZoomUnits(t){return Math.pow(2,18-t)}},W=O,F=class extends Cesium.WebMercatorTilingScheme{constructor(t){super(t);let e=new W;this._projection.project=function(i,s){return s=s||{},s=h.WGS84ToGCJ02(Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(i.latitude)),s=h.GCJ02ToBD09(s[0],s[1]),s[0]=Math.min(s[0],180),s[0]=Math.max(s[0],-180),s[1]=Math.min(s[1],74.000022),s[1]=Math.max(s[1],-71.988531),s=e.lngLatToPoint({lng:s[0],lat:s[1]}),new Cesium.Cartesian2(s.x,s.y)},this._projection.unproject=function(i,s){return s=s||{},s=e.mercatorToLngLat({lng:i.x,lat:i.y}),s=h.BD09ToGCJ02(s.lng,s.lat),s=h.GCJ02ToWGS84(s[0],s[1]),new Cesium.Cartographic(Cesium.Math.toRadians(s[0]),Cesium.Math.toRadians(s[1]))},this.resolutions=t.resolutions||[]}tileXYToNativeRectangle(t,e,i,s){let a=this.resolutions[i],o=t*a,r=(t+1)*a,n=((e=-e)+1)*a,c=e*a;return Cesium.defined(s)?(s.west=o,s.south=c,s.east=r,s.north=n,s):new Cesium.Rectangle(o,c,r,n)}positionToTileXY(t,e,i){let s=this._rectangle;if(!Cesium.Rectangle.contains(s,t))return;let a=this._projection.project(t);if(!Cesium.defined(a))return;let o=this.resolutions[e],r=Math.floor(a.x/o),n=-Math.floor(a.y/o);return Cesium.defined(i)?(i.x=r,i.y=n,i):new Cesium.Cartesian2(r,n)}},B=F,x={img:"//shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",vec:"//online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=020",custom:"//api{s}.map.bdimg.com/customimage/tile?&x={x}&y={y}&z={z}&scale=1&customid={style}",traffic:"//its.map.baidu.com:8002/traffic/TrafficTileService?time={time}&label={labelStyle}&v=016&level={z}&x={x}&y={y}&scaler=2"},U=class extends Cesium.UrlTemplateImageryProvider{constructor(t={}){if(t.url=t.url||[t.protocol||"",x[t.style]||x.custom].join(""),t.crs==="WGS84"){let e=[];for(let i=0;i<19;i++)e[i]=256*Math.pow(2,18-i);t.tilingScheme=new B({resolutions:e,rectangleSouthwestInMeters:new Cesium.Cartesian2(-2003772637e-2,-1247410417e-2),rectangleNortheastInMeters:new Cesium.Cartesian2(2003772637e-2,1247410417e-2)})}else t.tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:new Cesium.Cartesian2(-33554054,-33746824),rectangleNortheastInMeters:new Cesium.Cartesian2(33554054,33746824)});t.maximumLevel=18,super(t),this._rectangle=this._tilingScheme.rectangle,this._url=t.url,this._crs=t.crs||"BD09",this._style=t.style||"normal"}requestImage(t,e,i){let s=this._tilingScheme.getNumberOfXTilesAtLevel(i),a=this._tilingScheme.getNumberOfYTilesAtLevel(i),o=this._url.replace("{z}",i).replace("{s}",String(1)).replace("{style}",this._style);return this._crs==="WGS84"?o=o.replace("{x}",String(t)).replace("{y}",String(-e)):o=o.replace("{x}",String(t-s/2)).replace("{y}",String(a/2-e-1)),Cesium.ImageryProvider.loadImage(this,o)}},_=U,k="//tiles{s}.geovisearth.com/base/v1/{style}/{z}/{x}/{y}?format={format}&tmsIds=w&token={key}",A=class extends Cesium.UrlTemplateImageryProvider{constructor(t={}){t.url=t.url||[t.protocol||"",k.replace(/\{style\}/g,t.style||"vec").replace(/\{format\}/g,t.format||"png").replace(/\{key\}/g,t.key||"")].join(""),t.subdomains=t.subdomains||["1","2","3"],super(t)}},w=A,v={img:"https://gac-geo.googlecnapps.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}",elec:"https://gac-geo.googlecnapps.cn/maps/vt?lyrs=m&x={x}&y={y}&z={z}",cva:"https://gac-geo.googlecnapps.cn/maps/vt?lyrs=h&x={x}&y={y}&z={z}",ter:"https://gac-geo.googlecnapps.cn/maps/vt?lyrs=t@131,r&x={x}&y={y}&z={z}",img_cva:"https://gac-geo.googlecnapps.cn/maps/vt?lyrs=y&x={x}&y={y}&z={z}"},J=class extends Cesium.UrlTemplateImageryProvider{constructor(t={}){t.url=t.url||[t.protocol||"",v[t.style]||v.elec].join(""),t.crs==="WGS84"&&(t.tilingScheme=new d),super(t)}},z=J,X="//t{s}.tianditu.gov.cn/DataServer?T={style}_w&x={x}&y={y}&l={z}&tk={key}",Y=class extends Cesium.UrlTemplateImageryProvider{constructor(t={}){super({url:[t.protocol||"",X.replace(/\{style\}/g,t.style||"vec").replace(/\{key\}/g,t.key||"")].join(""),subdomains:["0","1","2","3","4","5","6","7"],maximumLevel:18})}},T=Y,S={img:"//p{s}.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{reverseY}.jpg?version=400",elec:"//rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid={style}&scene=0&version=347"},q=class extends Cesium.UrlTemplateImageryProvider{constructor(t={}){let e=t.url||[t.protocol||"",S[t.style]||S.elec].join("");t.url=e.replace("{style}",t.style||"1"),(!t.subdomains||!t.subdomains.length)&&(t.subdomains=["0","1","2"]),t.style==="img"&&(t.customTags={sx:(i,s,a,o)=>s>>4,sy:(i,s,a,o)=>(1<<o)-1-a>>4}),t.crs==="WGS84"&&(t.tilingScheme=new d),super(t)}},b=q,N=class extends Cesium.GeographicTilingScheme{constructor(t={}){super(t),this._origin=t.origin||[-180,90],this._zoomOffset=t.zoomOffset||0,this._tileSize=t.tileSize||256,this._resolutions=t.resolutions||[]}get zoomOffset(){return this._zoomOffset}tileXYToRectangle(t,e,i,s){if(!this._resolutions||!this._resolutions[i+this._zoomOffset])return Cesium.Rectangle.MAX_VALUE;let a=this._resolutions[i+this._zoomOffset]*this._tileSize,o=Cesium.Math.toRadians(this._origin[0]+t*a),r=Cesium.Math.toRadians(this._origin[1]-(e+1)*a),n=Cesium.Math.toRadians(this._origin[0]+(t+1)*a),c=Cesium.Math.toRadians(this._origin[1]-e*a);return Cesium.defined(s)?(s.west=o,s.south=r,s.east=n,s.north=c,s):new Cesium.Rectangle(o,r,n,c)}positionToTileXY(t,e,i){if(!this._resolutions||!this._resolutions[e+this._zoomOffset])return new Cesium.Cartesian2;let s=this._resolutions[e+this._zoomOffset]*this._tileSize,a=Cesium.Math.toDegrees(t.longitude),o=Cesium.Math.toDegrees(t.latitude),r=Math.floor((a-this._origin[0])/s),n=Math.floor((this._origin[1]-o)/s);return Cesium.defined(i)?(i.x=r,i.y=n,i):new Cesium.Cartesian2(Math.max(0,r),Math.max(0,n))}},L=N,V=class extends Cesium.WebMercatorTilingScheme{constructor(t={}){super(t),this._origin=t.origin||[-200375083427892e-7,200375083427892e-7],this._zoomOffset=t.zoomOffset||0,this._tileSize=t.tileSize||256,this._resolutions=t.resolutions||[]}get zoomOffset(){return this._zoomOffset}tileXYToNativeRectangle(t,e,i,s){if(!this._resolutions||!this._resolutions[i+this._zoomOffset]||t<0||e<0)return Cesium.Rectangle.MAX_VALUE;let a=this._resolutions[i+this._zoomOffset]*this._tileSize,o=this._origin[0]+t*a,r=this._origin[1]-(e+1)*a,n=this._origin[0]+(t+1)*a,c=this._origin[1]-e*a;return Cesium.defined(s)?(s.west=o,s.south=r,s.east=n,s.north=c,s):new Cesium.Rectangle(o,r,n,c)}positionToTileXY(t,e,i){let s=this._rectangle;if(!Cesium.Rectangle.contains(s,t))return;if(!this._resolutions||!this._resolutions[e+this._zoomOffset])return new Cesium.Cartesian2;let a=this._resolutions[e+this._zoomOffset]*this._tileSize,o=this._projection.project(t),r=Math.floor((o.x-this._origin[0])/a),n=Math.floor((this._origin[1]-o.y)/a);return Cesium.defined(i)?(i.x=r,i.y=n,i):new Cesium.Cartesian2(Math.max(0,r),Math.max(0,n))}},R=V;window&&window.Cesium&&(Object.isFrozen(window.Cesium)?(window.AMapImageryProvider=m,window.BaiduImageryProvider=_,window.GeoVisImageryProvider=w,window.GoogleImageryProvider=z,window.TdtImageryProvider=T,window.TencentImageryProvider=b,window.CustomGeographicTilingScheme=L,window.CustomMercatorTilingScheme=R):(window.Cesium.AMapImageryProvider=m,window.Cesium.BaiduImageryProvider=_,window.Cesium.GeoVisImageryProvider=w,window.Cesium.GoogleImageryProvider=z,window.Cesium.TdtImageryProvider=T,window.Cesium.TencentImageryProvider=b,window.Cesium.CustomGeographicTilingScheme=L,window.Cesium.CustomMercatorTilingScheme=R));function E({viewer:t,style:e="dark",changeColor:i=!0}){const s={style:e,crs:"WGS84"};if(t.imageryLayers.add(new Cesium.ImageryLayer(new m(s))),i){t.imageryLayers.get(0);const a={invertColor:!0,filterRGB:[0,50,100]},o=t.scene._globe._surfaceShaderSet.baseFragmentShaderSource.sources;for(let r=0;r<o.length;r++){const n=`color = czm_saturation(color, textureSaturation);
#endif
`;let c=`color = czm_saturation(color, textureSaturation);
#endif
`;c+=`
    color.r = 1.0 - color.r;
    color.g = 1.0 - color.g;
    color.b = 1.0 - color.b;
    `,a.filterRGB.length>0&&(c+=`
    color.r = color.r * ${a.filterRGB[0]}.0/255.0;
    color.g = color.g * ${a.filterRGB[1]}.0/255.0;
    color.b = color.b * ${a.filterRGB[2]}.0/255.0;
    `),o[r]=o[r].replace(n,c)}}}export{E as m};
