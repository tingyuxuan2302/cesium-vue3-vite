import{_ as W}from"./OperateBox.0986405a.js";import{C as O,o as U,b as Y,d as E,w as x,aL as z,L as V,e as S}from"./index.fe5814f1.js";import{E as H}from"./el-button.af2fec77.js";import{S as J}from"./LoadGif.605f9a74.js";import{a as $}from"./axios.a5b46551.js";const ee={__name:"typhoon",setup(q){const{viewer:t}=window;let g=[],l=null,n=0,a,u,m=null;O(()=>{v()});async function v(){t.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(120,20,4025692)}),A()}function A(){t.entities.add({name:"24",polyline:{positions:Cesium.Cartesian3.fromDegreesArray([127,34,127,22,119,18,119,11,113,4.5,105,0]),width:2,material:Cesium.Color.RED,clampToGround:!0}}),t.entities.add({name:"48",polyline:{positions:Cesium.Cartesian3.fromDegreesArray([132,34,132,22,119,0,105,0]),width:2,material:Cesium.Color.YELLOW,clampToGround:!0}}),t.entities.add({position:Cesium.Cartesian3.fromDegrees(126.129019,29.104287),label:{fillColor:Cesium.Color.RED,text:"24\u5C0F\u65F6\u8B66\u6212\u7EBF",font:"14pt monospace"}}),t.entities.add({position:Cesium.Cartesian3.fromDegrees(132,20),label:{fillColor:Cesium.Color.YELLOW,text:"48\u5C0F\u65F6\u8B66\u6212\u7EBF",font:"14pt monospace"}})}function R(){k(),l=new Cesium.CustomDataSource("initPointsCollection"),t.dataSources.add(l),$.get("/cesium-vue3-vite/json/typhoon.json").then(o=>{let e=o.data.points,r=[];e.forEach(i=>{let s=Cesium.Color.RED;r.push(Number(i.lng)),r.push(Number(i.lat)),i.strong=="\u70ED\u5E26\u4F4E\u538B"?s=Cesium.Color.GREEN:i.strong=="\u70ED\u5E26\u98CE\u66B4"?s=Cesium.Color.BLUE:i.strong=="\u5F3A\u70ED\u5E26\u98CE\u66B4"?s=Cesium.Color.YELLOW:i.strong=="\u53F0\u98CE"?s=Cesium.Color.fromCssColorString("#FBC712"):i.strong=="\u5F3A\u53F0\u98CE"?s=Cesium.Color.PLUM:i.strong=="\u8D85\u5F3A\u53F0\u98CE"&&(s=Cesium.Color.RED);var p=new Cesium.Entity({position:Cesium.Cartesian3.fromDegrees(Number(i.lng),Number(i.lat)),point:{pixelSize:5,color:s}});l.entities.add(p)}),t.entities.add({polyline:{positions:Cesium.Cartesian3.fromDegreesArray(r),width:3,clampToGround:!0,material:Cesium.Color.RED}}),T(e[e.length-1]),B(e)})}function T(o){let e=o.forecast,r=[Cesium.Color.fromCssColorString("#2D12FB"),Cesium.Color.fromCssColorString("#15E5E7"),Cesium.Color.fromCssColorString("#15E74A"),Cesium.Color.fromCssColorString("#E76F15"),Cesium.Color.fromCssColorString("#15D9E7")];e.forEach((i,s)=>{let p=[];i.forecastpoints.forEach(d=>{p.push(Number(d.lng)),p.push(Number(d.lat));var C=new Cesium.Entity({position:Cesium.Cartesian3.fromDegrees(Number(d.lng),Number(d.lat)),point:{pixelSize:7,color:r[s]}});l.entities.add(C)}),t.entities.add({polyline:{positions:Cesium.Cartesian3.fromDegreesArray(p),width:2,clampToGround:!0,material:new Cesium.PolylineDashMaterialProperty({color:r[s]})}})})}function B(o){G(),m=setInterval(function(){let e=n*2;a={lon:Number(o[n].lng),lat:Number(o[n].lat),circle7:{radius1:350-e,radius2:450-e,radius3:400-e,radius4:350-e},circle10:{radius1:250-e,radius2:270-e,radius3:250-e,radius4:220-e},circle12:{radius1:170-e,radius2:150-e,radius3:150-e,radius4:170-e}},u&&(u.position=Cesium.Cartesian3.fromDegrees(Number(o[n].lng),Number(o[n].lat))),n>99?n=0:n=n+1,w(),F()},200)}function G(){return new Promise(o=>{let e=document.createElement("div"),r=document.createElement("img");e.appendChild(r),r.src="/cesium-vue3-vite/images/tf.gif",r.onload=()=>{let i=new J({gif:r});i.load(()=>{u=t.entities.add({position:Cesium.Cartesian3.fromDegrees(75.166493,39.9060534),billboard:{image:new Cesium.CallbackProperty(()=>i.get_canvas().toDataURL("image/png"),!1),scale:.1}}),o(u)})}})}function w(){let o=g;for(let e=0;e<o.length;e++)t.entities.remove(o[e]);g=[]}function F(){["circle7","circle10","circle12"].forEach(e=>{let r=t.entities.add({id:`tf_polygon_${e}`,name:`tf_polygon_${e}`,polygon:{hierarchy:new Cesium.CallbackProperty(()=>{let i=[];return a&&a[e]?i=D(a,e):i=[],new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArray(i))},!1),material:Cesium.Color.ORANGE.withAlpha(.05),extrudedHeight:1e3,outline:!0,outlineColor:Cesium.Color.ORANGE,outlineWidth:2},polyline:{positions:new Cesium.CallbackProperty(()=>{let i=[];return a&&a[e]?i=D(a,e):i=[],Cesium.Cartesian3.fromDegreesArray(i)},!1),material:Cesium.Color.ORANGE,width:2,height:1e3}});g.push(r)})}function D(o,e){let r=[],i=[o.lon*1,o.lat*1],s=[o[e].radius1,o[e].radius2,o[e].radius3,o[e].radius4],p=[0,90,180,270],d,C;return p.forEach((c,M)=>{let _=s[M]/100,L=90,I=c+90,N,P,y,h,b;for(let f=0;f<=L;f++)b=c+(I-c)*f/L,N=Math.sin(b*Math.PI/180),P=Math.cos(b*Math.PI/180),y=i[0]+_*N,h=i[1]+_*P,r.push(y,h),c==0&&f==0&&(d=y,C=h)}),r.push(d,C),r}function k(){w(),l&&(t.dataSources.remove(l),l=null),m&&(clearInterval(m),m=null),u&&(t.entities.remove(u),u=void 0),n=0}return(o,e)=>{const r=H,i=W;return U(),Y(V,null,[E(i,{style:{display:"flex","flex-direction":"row",gap:"5px"}},{default:x(()=>[E(r,{type:"primary",onClick:R},{default:x(()=>e[0]||(e[0]=[S("\u52A0\u8F7D\u53F0\u98CE\u6570\u636E")])),_:1}),E(r,{type:"danger",onClick:k},{default:x(()=>e[1]||(e[1]=[S("\u6E05\u9664")])),_:1})]),_:1}),e[2]||(e[2]=z('<ul style="position:absolute;z-index:100;bottom:30px;right:10px;color:#fff;background:#000000cc;list-style:none;"><li><span style="border-radius:10px;width:10px;height:10px;display:inline-block;background:GREEN;"></span><span>\u70ED\u5E26\u4F4E\u538B</span></li><li><span style="border-radius:10px;width:10px;height:10px;display:inline-block;background:BLUE;"></span><span>\u70ED\u5E26\u98CE\u66B4</span></li><li><span style="border-radius:10px;width:10px;height:10px;display:inline-block;background:YELLOW;"></span><span>\u5F3A\u70ED\u5E26\u98CE\u66B4</span></li><li><span style="border-radius:10px;width:10px;height:10px;display:inline-block;background:#FBC712;"></span><span>\u53F0\u98CE</span></li><li><span style="border-radius:10px;width:10px;height:10px;display:inline-block;background:RED;"></span><span>\u8D85\u5F3A\u53F0\u98CE</span></li></ul>',1))],64)}}};export{ee as default};
