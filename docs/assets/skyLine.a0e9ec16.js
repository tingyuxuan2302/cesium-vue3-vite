var p=Object.defineProperty;var f=(o,e,t)=>e in o?p(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var n=(o,e,t)=>(f(o,typeof e!="symbol"?e+"":e,t),t);import{_ as x}from"./OperateBox.66cb383c.js";import{u as h,D as g,a as C,o as _,c as v,w as a,d as u,e as c}from"./index.bc967ea1.js";import{E as y}from"./el-button.3d1567a4.js";class S{constructor(e){n(this,"skylineAnayStages",null);n(this,"silhouette",null);this.viewer=e}open(){if(this.skylineAnayStages){this.silhouette.enabled=!0;return}this.skylineAnayStages=this.viewer.scene.postProcessStages;let e=Cesium.PostProcessStageLibrary.createEdgeDetectionStage(),t=new Cesium.PostProcessStage({fragmentShader:"uniform sampler2D colorTexture;uniform sampler2D depthTexture;in vec2 v_textureCoordinates;out vec4 fragColor;void main(void){float depth = czm_readDepth(depthTexture, v_textureCoordinates);vec4 color = texture(colorTexture, v_textureCoordinates);if(depth<1.0 - 0.000001){fragColor = color;}else{fragColor = vec4(1.0,0.0,0.0,1.0);}}"}),r=new Cesium.PostProcessStage({fragmentShader:"uniform sampler2D colorTexture;uniform sampler2D redTexture;uniform sampler2D silhouetteTexture;in vec2 v_textureCoordinates;out vec4 fragColor;void main(void){vec4 redcolor=texture(redTexture, v_textureCoordinates);vec4 silhouetteColor = texture(silhouetteTexture, v_textureCoordinates);vec4 color = texture(colorTexture, v_textureCoordinates);if(redcolor.r == 1.0){fragColor = mix(color, vec4(5.0,0.0,0.0,1.0), silhouetteColor.a);}else{fragColor = color;}}",uniforms:{redTexture:t.name,silhouetteTexture:e.name}});this.silhouette=new Cesium.PostProcessStageComposite({stages:[e,t,r],inputPreviousStageTexture:!1,uniforms:e.uniforms}),this.skylineAnayStages.add(this.silhouette)}close(){this.silhouette.enabled=!1}}const A={__name:"skyLine",setup(o){const e=h(),{viewer:t}=e.state;let r;g(async()=>{t.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(120.58193064609729,36.125460378632766,200),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(0),roll:0},duration:3})});const m=async()=>{r=new S(t),r.open()},i=()=>{r.close()};return C(()=>{i()}),(T,s)=>{const l=y,d=x;return _(),v(d,null,{default:a(()=>[u(l,{onClick:m,type:"primary"},{default:a(()=>s[0]||(s[0]=[c("\u6253\u5F00\u5929\u9645\u7EBF")])),_:1}),u(l,{onClick:i,type:"primary"},{default:a(()=>s[1]||(s[1]=[c("\u5173\u95ED\u5929\u9645\u7EBF")])),_:1})]),_:1})}}};export{A as default};
