import{o as h,b as f}from"./index.76f76e18.js";const x=`uniform samplerCube u_cubeMap;
    in vec3 v_texCoord;
    out vec4 fragColor;
    void main(){
        vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));
        fragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);
    }
`,g=`
    out vec3 position;
    in vec3 v_texCoord;
    uniform mat3 u_rotateMatrix;
    void main(){
        vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));
        gl_Position = czm_projection * vec4(p, 1.0);
        v_texCoord = position.xyz;
    }
`,u=Cesium.BoxGeometry,_=Cesium.Cartesian3,y=Cesium.defaultValue,s=Cesium.defined,C=Cesium.destroyObject,m=Cesium.DeveloperError,v=Cesium.GeometryPipeline,b=Cesium.Matrix3,c=Cesium.Matrix4,M=Cesium.Transforms,l=Cesium.VertexFormat,S=Cesium.BufferUsage,B=Cesium.CubeMap,k=Cesium.DrawCommand,w=Cesium.loadCubeMap,P=Cesium.RenderState,A=Cesium.VertexArray,X=Cesium.BlendingState,d=Cesium.SceneMode,D=Cesium.ShaderProgram,L=Cesium.ShaderSource,z=new b;Cesium.defined(Cesium.Matrix4.getRotation)||(Cesium.Matrix4.getRotation=Cesium.Matrix4.getMatrix3);class Y{constructor(e){this.sources=e.sources,this._sources=void 0,this.show=y(e.show,!0),this._command=new k({modelMatrix:c.clone(c.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}update(e,r){const i=this;if(!this.show||e.mode!==d.SCENE3D&&e.mode!==d.MORPHING||!e.passes.render)return;const n=e.context;if(this._sources!==this.sources){this._sources=this.sources;const t=this.sources;if(!s(t.positiveX)||!s(t.negativeX)||!s(t.positiveY)||!s(t.negativeY)||!s(t.positiveZ)||!s(t.negativeZ))throw new m("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof t.positiveX!=typeof t.negativeX||typeof t.positiveX!=typeof t.positiveY||typeof t.positiveX!=typeof t.negativeY||typeof t.positiveX!=typeof t.positiveZ||typeof t.positiveX!=typeof t.negativeZ)throw new m("this.sources properties must all be the same type.");typeof t.positiveX=="string"?w(n,this._sources).then(function(a){i._cubeMap=i._cubeMap&&i._cubeMap.destroy(),i._cubeMap=a}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new B({context:n,source:t}))}const o=this._command;if(o.modelMatrix=M.eastNorthUpToFixedFrame(e.camera._positionWC),!s(o.vertexArray)){o.uniformMap={u_cubeMap:function(){return i._cubeMap},u_rotateMatrix:function(){return c.getRotation(o.modelMatrix,z)}};const t=u.createGeometry(u.fromDimensions({dimensions:new _(2,2,2),vertexFormat:l.POSITION_ONLY})),a=this._attributeLocations=v.createAttributeLocations(t);o.vertexArray=A.fromGeometry({context:n,geometry:t,attributeLocations:a,bufferUsage:S._DRAW}),o.renderState=P.fromCache({blending:X.ALPHA_BLEND})}if(!s(o.shaderProgram)||this._useHdr!==r){const t=new L({defines:[r?"HDR":""],sources:[x]});o.shaderProgram=D.fromCache({context:n,vertexShaderSource:g,fragmentShaderSource:t,attributeLocations:this._attributeLocations}),this._useHdr=r}if(!!s(this._cubeMap))return o}setSkyBox(e){let r=e.scene.skyBox;e.scene.preUpdate.addEventListener(()=>{let i=e.scene.camera.position;Cesium.Cartographic.fromCartesian(i).height<24e4?(e.scene.skyBox=this,e.scene.skyAtmosphere.show=!1):(e.scene.skyBox=r,e.scene.skyAtmosphere.show=!0)})}isDestroyed(){return!1}destroy(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),C(this)}}const E={__name:"skybox",setup(p){const{viewer:e}=window;return new Y({sources:{positiveX:"/cesium-vue3-vite/images/Standard-Cube-Map/px1.png",negativeX:"/cesium-vue3-vite/images/Standard-Cube-Map/nx1.png",positiveY:"/cesium-vue3-vite/images/Standard-Cube-Map/pz.png",negativeY:"/cesium-vue3-vite/images/Standard-Cube-Map/nz1.png",positiveZ:"/cesium-vue3-vite/images/Standard-Cube-Map/py.png",negativeZ:"/cesium-vue3-vite/images/Standard-Cube-Map/ny1.png"}}).setSkyBox(e),(i,n)=>(h(),f("div"))}};export{E as default};
