var d=Object.defineProperty;var p=(o,e,t)=>e in o?d(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var s=(o,e,t)=>(p(o,typeof e!="symbol"?e+"":e,t),t);import{_ as f}from"./OperateBox.9c1989a1.js";import{u as h,y as _,a as x,o as g,c as C,w as a,d as l,e as u}from"./index.f73e044e.js";import{E as v}from"./el-button.456a72d6.js";class y{constructor(e){s(this,"skylineAnayStages",null);s(this,"silhouette",null);this.viewer=e}open(){if(this.skylineAnayStages){this.silhouette.enabled=!0;return}this.skylineAnayStages=this.viewer.scene.postProcessStages;let e=Cesium.PostProcessStageLibrary.createEdgeDetectionStage(),t=new Cesium.PostProcessStage({fragmentShader:"uniform sampler2D colorTexture;uniform sampler2D depthTexture;in vec2 v_textureCoordinates;out vec4 fragColor;void main(void){float depth = czm_readDepth(depthTexture, v_textureCoordinates);vec4 color = texture(colorTexture, v_textureCoordinates);if(depth<1.0 - 0.000001){fragColor = color;}else{fragColor = vec4(1.0,0.0,0.0,1.0);}}"}),r=new Cesium.PostProcessStage({fragmentShader:"uniform sampler2D colorTexture;uniform sampler2D redTexture;uniform sampler2D silhouetteTexture;in vec2 v_textureCoordinates;out vec4 fragColor;void main(void){vec4 redcolor=texture(redTexture, v_textureCoordinates);vec4 silhouetteColor = texture(silhouetteTexture, v_textureCoordinates);vec4 color = texture(colorTexture, v_textureCoordinates);if(redcolor.r == 1.0){fragColor = mix(color, vec4(5.0,0.0,0.0,1.0), silhouetteColor.a);}else{fragColor = color;}}",uniforms:{redTexture:t.name,silhouetteTexture:e.name}});this.silhouette=new Cesium.PostProcessStageComposite({stages:[e,t,r],inputPreviousStageTexture:!1,uniforms:e.uniforms}),this.skylineAnayStages.add(this.silhouette)}close(){this.silhouette.enabled=!1}}const A={__name:"skyLine",setup(o){const e=h(),{viewer:t}=e.state;let r;_(async()=>{t.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(120.58193064609729,36.125460378632766,200),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(0),roll:0},duration:3})});const c=async()=>{r=new y(t),r.open()},n=()=>{r.close()};return x(()=>{n()}),(S,T)=>{const i=v,m=f;return g(),C(m,null,{default:a(()=>[l(i,{onClick:c,type:"primary"},{default:a(()=>[u("\u6253\u5F00\u5929\u9645\u7EBF")]),_:1}),l(i,{onClick:n,type:"primary"},{default:a(()=>[u("\u5173\u95ED\u5929\u9645\u7EBF")]),_:1})]),_:1})}}};export{A as default};
