import{_,o as l,b as d,X as n,L as r,e as h,Y as p,M as v,Z as u,$ as w,a0 as y,a1 as C}from"./index.f73e044e.js";const m=t=>(u("data-v-3b937a03"),t=t(),w(),t),g={class:"popup-container"},f=m(()=>n("div",{class:"pine"},null,-1)),I={class:"box-wrap"},b={class:"area"},$={class:"area-title fontColor"},k={class:"content"},x={class:"data-li"},R=m(()=>n("div",{class:"data-label textColor"},"\u5730\u5740\uFF1A",-1)),S={class:"data-value"},E={class:"label-num yellowColor"},P={__name:"Popup",props:{title:{type:String,default:"\u6807\u9898"},content:{type:String,default:"\u5185\u5BB9"},closeEvent:Function},setup(t){const e=t,s=()=>{e==null||e.closeEvent()};return(i,a)=>(l(),d("div",g,[f,n("div",I,[n("div",{class:"close",onClick:s},"X"),n("div",b,[n("div",$,[e.title?(l(),d(r,{key:0},[h(p(e.title),1)],64)):v(i.$slots,"title",{key:1},void 0,!0)])]),n("div",k,[n("div",x,[R,n("div",S,[n("span",E,[e.content?(l(),d(r,{key:0},[h(p(e.content),1)],64)):v(i.$slots,"content",{key:1},void 0,!0)])])])])])]))}},T=_(P,[["__scopeId","data-v-3b937a03"]]);class B{constructor(e){const{viewer:s,position:i,...a}=e;this.viewer=s,this.position=i._value;const{vmInstance:c}=D({...a,closeEvent:this.windowClose.bind(this)});this.vmInstance?this.windowClose.bind(this):this.vmInstance=c,s.cesiumWidget.container.appendChild(c.$el),this.addPostRender()}addPostRender(){this.viewer.scene.postRender.addEventListener(this.postRender,this)}postRender(){if(!this.vmInstance.$el||!this.vmInstance.$el.style)return;const e=this.viewer.scene.canvas.height,s=new Cesium.Cartesian2;Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.viewer.scene,this.position,s),this.vmInstance.$el.style.bottom=e-s.y+260+"px";const i=this.vmInstance.$el.offsetWidth;this.vmInstance.$el.style.left=s.x-i/2+110+"px";const a=this.viewer.camera.position;let c=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(a).height;c+=this.viewer.scene.globe.ellipsoid.maximumRadius,!(Cesium.Cartesian3.distance(a,this.position)>c)&&this.viewer.camera.positionCartographic.height<5e7?this.vmInstance.$el.style.display="block":this.vmInstance.$el.style.display="none"}windowClose(){this.vmInstance&&this.vmInstance.$el.remove(),this.viewer.scene.postRender.removeEventListener(this.postRender,this)}}let o=null;const D=t=>{o&&(document.body.removeChild(o),o=null);const e=y({render(){return C(T,{...t},{title:()=>t.slotTitle,content:()=>t.slotContent})}});o=document.createElement("div");const s=e.mount(o);return document.body.appendChild(o),{vmInstance:s}};export{B as D};
