import{_ as E}from"./OperateBox.66cb383c.js";import{u as T,D as b,a as x,o as D,c as G,w as l,d as p,e as f}from"./index.bc967ea1.js";import{E as j}from"./el-button.3d1567a4.js";import{g as k}from"./api.0d3194e0.js";import{m as V}from"./modifyMap.01247dc3.js";import"./request.00b81209.js";function o(i,r){this._definitionChanged=new Cesium.Event,this.duration=i,this.image=r,this._time=performance.now()}Object.defineProperties(o.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),duration:Cesium.createPropertyDescriptor("duration")});o.prototype.getType=function(i){return"Spriteline1"};o.prototype.getValue=function(i,r){return Cesium.defined(r)||(r={}),r.image=this.image,r.time=(performance.now()-this._time)%this.duration/this.duration,r};o.prototype.equals=function(i){return this===i||i instanceof o&&this.duration===i.duration};Cesium.Material.Spriteline1Type="Spriteline1";Cesium.Material.Spriteline1Source=`
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec4 colorImage = texture(image, vec2(fract(st.s - time), st.t));
material.alpha = colorImage.a;
material.diffuse = colorImage.rgb * 1.5 ;
return material;
}
`;Cesium.Material._materialCache.addMaterial(Cesium.Material.Spriteline1Type,{fabric:{type:Cesium.Material.Spriteline1Type,uniforms:{color:new Cesium.Color(1,0,0,.5),image:"",transparent:!0,time:20},source:Cesium.Material.Spriteline1Source},translucent:function(i){return!0}});const C="/cesium-vue3-vite/json/qingdaoRoad.geojson",U={__name:"throughRoad",setup(i){const r=T(),{viewer:a}=r.state;b(()=>{a.scene.terrainProvider=new Cesium.EllipsoidTerrainProvider({}),V({viewer:a})}),a.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120.188,36.67,2e5)});let s=null;const y=new o(1e3,"/cesium-vue3-vite/images/spriteline.png"),_=()=>{s=new Cesium.GeoJsonDataSource,s.load(C).then(function(m){const e=m.entities.values;for(let t=0;t<e.length;t++){let n=e[t];n.polyline.width=1.7,n.polyline.material=y}}),a.dataSources.add(s)};let c=null;const h=async()=>{const{res:m}=await k(C),{features:e}=m,t=[];if(e!=null&&e.length){e.forEach(S=>{S.geometry.coordinates.forEach(M=>{let u=[];M.forEach(z=>{u=u.concat(z)});const I=new Cesium.PolylineGeometry({positions:Cesium.Cartesian3.fromDegreesArray(u),width:1.7,vertexFormat:Cesium.PolylineMaterialAppearance.VERTEX_FORMAT}),P=Cesium.PolylineGeometry.createGeometry(I);t.push(new Cesium.GeometryInstance({geometry:P}))})}),console.log("-----instance-----",Cesium.Material.Spriteline1Source);let n=`czm_material czm_getMaterial(czm_materialInput materialInput)
                          {
                             czm_material material = czm_getDefaultMaterial(materialInput);
                             vec2 st = materialInput.st;
                             vec4 colorImage = texture(image, vec2(fract((st.s - speed * czm_frameNumber * 0.001)), st.t));
                             material.alpha = colorImage.a * color.a;
                             material.diffuse = colorImage.rgb * 1.5 ;
                             return material;
                          }`;const v=new Cesium.Material({fabric:{uniforms:{color:Cesium.Color.fromCssColorString("#7ffeff"),image:"/cesium-vue3-vite/images/spriteline.png",speed:10},source:n},translucent:function(){return!0}}),g=new Cesium.PolylineMaterialAppearance;g.material=v;const w=new Cesium.Primitive({geometryInstances:t,appearance:g,asynchronous:!1});c=a.scene.primitives.add(w)}},d=()=>{s&&a.dataSources.remove(s,!1),c&&a.scene.primitives.remove(c)};return x(()=>{d(),a.scene.terrainProvider=new Cesium.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"})}),(m,e)=>{const t=j,n=E;return D(),G(n,null,{default:l(()=>[p(t,{type:"primary",onClick:_},{default:l(()=>e[0]||(e[0]=[f("\u5F00\u59CB(entity\u6E32\u67D3)")])),_:1}),p(t,{type:"primary",onClick:h},{default:l(()=>e[1]||(e[1]=[f("\u5F00\u59CB(primitive\u6E32\u67D3)")])),_:1}),p(t,{type:"primary",onClick:d},{default:l(()=>e[2]||(e[2]=[f("\u6E05\u9664")])),_:1})]),_:1})}}};export{U as default};
