import{_ as d}from"./OperateBox.66cb383c.js";import{u as p,a as h,o as C,c as w,w as n,d as o,e as m}from"./index.bc967ea1.js";import{E as f}from"./el-button.3d1567a4.js";class v{constructor(e){this.viewer=e,this.viewModel={startScale:1,endScale:4,minimumParticleLife:1,maximumParticleLife:3,minimumSpeed:1,maximumSpeed:8,particleSize:20,emissionRate:5},this.emitterModelMatrix=new Cesium.Matrix4,this.translation=new Cesium.Cartesian3,this.rotation=new Cesium.Quaternion,this.hpr=new Cesium.HeadingPitchRoll,this.trs=new Cesium.TranslationRotationScale,this.scene=this.viewer.scene,this.particleSystem="",this.entity=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(120.36,36.09)}),this.init()}init(){this.viewer.clock.shouldAnimate=!0,this.viewer.scene.globe.depthTestAgainstTerrain=!1;const e=10,t=20;var i=this.scene.primitives.add(new Cesium.ParticleSystem({emitter:new Cesium.ConeEmitter(Cesium.Math.toRadians(45)),image:"/cesium-vue3-vite/images/fire.png",startColor:Cesium.Color.RED,endColor:Cesium.Color.YELLOW,startScale:1,endScale:3,particleLife:1.5,speed:10,emissionRate:200,imageSize:new Cesium.Cartesian2(25,25),bursts:[new Cesium.ParticleBurst({time:0,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.1,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.2,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.3,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.4,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.5,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.6,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.7,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.8,minimum:e,maximum:t}),new Cesium.ParticleBurst({time:.9,minimum:e,maximum:t})]}));this.particleSystem=i,this.preUpdateEvent()}preUpdateEvent(){let e=this;this.viewer.scene.preUpdate.addEventListener(function(t,i){e.particleSystem.modelMatrix=e.computeModelMatrix(e.entity,i),e.particleSystem.emitterModelMatrix=e.computeEmitterModelMatrix(),e.viewModel.spin&&(e.viewModel.heading+=1,e.viewModel.pitch+=1,e.viewModel.roll+=1)})}computeModelMatrix(e,t){return e.computeModelMatrix(t,new Cesium.Matrix4)}computeEmitterModelMatrix(){return this.hpr=Cesium.HeadingPitchRoll.fromDegrees(0,0,0,this.hpr),this.trs.translation=Cesium.Cartesian3.fromElements(-4,0,1.4,this.translation),this.trs.rotation=Cesium.Quaternion.fromHeadingPitchRoll(this.hpr,this.rotation),Cesium.Matrix4.fromTranslationRotationScale(this.trs,this.emitterModelMatrix)}removeEvent(){this.viewer.scene.preUpdate.removeEventListener(this.preUpdateEvent,this),this.emitterModelMatrix=void 0,this.translation=void 0,this.rotation=void 0,this.hpr=void 0,this.trs=void 0}remove(){this.viewer.scene.primitives.remove(this.particleSystem),this.viewer.entities.remove(this.entity)}}const M=r=>new Promise(e=>{setTimeout(e,r)}),y={__name:"fire",setup(r){const e=p(),{viewer:t}=e.state;let i;const l=async()=>{t.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(120.361,36.0885,80),orientation:{direction:new Cesium.Cartesian3(.7458181136018,-.4270255968894706,.5112773034515067),up:new Cesium.Cartesian3(-.19274344830978868,.5963500021825172,.7792410654159365)},duration:3}),await M(3e3),i=new v(t)},u=()=>{i.remove()};return h(()=>{i&&i.remove()}),(x,s)=>{const a=f,c=d;return C(),w(c,null,{default:n(()=>[o(a,{type:"primary",onClick:l},{default:n(()=>s[0]||(s[0]=[m("\u6E32\u67D3\u706B\u7130")])),_:1}),o(a,{type:"primary",onClick:u},{default:n(()=>s[1]||(s[1]=[m("\u6E05\u9664")])),_:1})]),_:1})}}};export{y as default};
