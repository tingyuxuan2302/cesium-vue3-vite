import{_ as l,h as m,C as c,aK as u,o as d,b as h}from"./index.76f76e18.js";class o{constructor(e={}){this.opts={color:Cesium.Color.RED,duration:2e3,time:new Date().getTime(),repeat:30,offset:0,thickness:.3,...e},this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=this.opts.color,this.duration=this.opts.duration,this._time=this.opts.time}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(){return"radarPrimitive"}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrClonedDefault(this._color,e,Cesium.Color.WHITE,t.color),t.time=(new Date().getTime()-this._time)%this.duration/this.duration/10,t.repeat=this.opts.repeat,t.offset=this.opts.offset,t.thickness=this.opts.thickness,t}equals(e){return this===e||e instanceof o&&Cesium.Property.equals(this._color,e._color)}}Object.defineProperties(o.prototype,{color:Cesium.createPropertyDescriptor("color")});class p{constructor(e,t={}){this.viewer=e,this.options={position:[114,35,5e5],heading:135,color:Cesium.Color.CORAL,length:5e5,bottomRadius:5e4,thickness:.1,...t},this.init()}init(){this._registerRadarMaterial(),this.createRadarCone()}_registerRadarMaterial(){Cesium.Material.radarPrimitiveType||(Cesium.Material.radarPrimitiveType="radarPrimitive",Cesium.Material.radarPrimitiveSource=`
        uniform vec4 color;
        uniform float repeat;
        uniform float offset;
        uniform float thickness;
        czm_material czm_getMaterial(czm_materialInput materialInput) {
          czm_material material = czm_getDefaultMaterial(materialInput);
          float sp = 1.0/repeat;
          vec2 st = materialInput.st;
          float dis = distance(st, vec2(0.5));
          float m = mod(dis + offset-time, sp);
          float a = step(sp*(1.0-thickness), m);
          material.diffuse = color.rgb;
          material.alpha = a * color.a;
          return material;
        }`,Cesium.Material._materialCache.addMaterial(Cesium.Material.radarPrimitiveType,{fabric:{type:Cesium.Material.radarPrimitiveType,uniforms:{color:new Cesium.Color(1,0,0,.5),time:0,repeat:30,offset:0,thickness:.3},source:Cesium.Material.radarPrimitiveSource},translucent:function(){return!0}}))}createRadarCone(){const e=Cesium.Cartesian3.fromDegrees(...this.options.position),t=Cesium.Math.toRadians(this.options.heading),i=Cesium.Math.toRadians(0),a=Cesium.Math.toRadians(0),s=new Cesium.HeadingPitchRoll(t,i,a),n=Cesium.Transforms.headingPitchRollQuaternion(e,s);return this.entity=this.viewer.entities.add({name:"Radar Cone",position:e,orientation:n,cylinder:{length:this.options.length,topRadius:0,bottomRadius:this.options.bottomRadius,material:new o({color:this.options.color,thickness:this.options.thickness})}}),this.entity}destroy(){this.entity&&(this.viewer.entities.remove(this.entity),this.entity=null)}zoomTo(){this.entity&&this.viewer.zoomTo(this.entity)}}const f={__name:"radarEmission",setup(r){const e=m(null);let t=null,i=null;return c(()=>{t=new Cesium.Viewer(e.value,{terrainProvider:Cesium.createWorldTerrain()}),i=new p(t,{position:[114,35,5e5],heading:135,color:Cesium.Color.CYAN,length:5e5,bottomRadius:5e4,thickness:.1}),i.zoomTo()}),u(()=>{i&&i.destroy(),t&&(t.destroy(),t=null)}),(a,s)=>(d(),h("div",{class:"map-container",ref_key:"mapContainer",ref:e},null,512))}},_=l(f,[["__scopeId","data-v-5ad5d177"]]);export{_ as default};
