import{_ as R}from"./OperateBox.66cb383c.js";import{u as T,D as I,a as d,o as L,c as P,w as c,d as C,e as g}from"./index.bc967ea1.js";import{E as x}from"./el-button.3d1567a4.js";import{g as y}from"./api.0d3194e0.js";import"./request.00b81209.js";const k={__name:"colorLayer",setup(N){const f=T(),{viewer:o}=f.state;I(()=>{o.scene.terrainProvider=new Cesium.EllipsoidTerrainProvider({})}),d(()=>{o.scene.terrainProvider=new Cesium.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"})}),o.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120.36,36.09,4e4)});const E=async()=>{const{res:t}=await y("/cesium-vue3-vite/json/qingdaoArea.geojson"),{res:e}=await y("/cesium-vue3-vite/json/areaPoint.geojson");w(t.features,e)},A=o.scene.primitives.add(new Cesium.LabelCollection),_=["AQUAMARINE","BEIGE","CORNFLOWERBLUE","DARKORANGE","GOLD","GREENYELLOW","LIGHTPINK","ORANGERED","YELLOWGREEN","TOMATO"],m=[],w=(t,e)=>{let n=[];for(let r=0;r<t.length;r++){const i=t[r];for(let s=0;s<i.geometry.coordinates.length;s++){const O=i.geometry.coordinates[s].toString().split(",").map(Number),v=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArray(O)),vertexFormat:Cesium.PerInstanceColorAppearance.VERTEX_FORMAT,extrudedHeight:100}),G=Cesium.PolygonGeometry.createGeometry(v);n.push(new Cesium.GeometryInstance({id:`polygon-${r}`,geometry:G,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromAlpha(Cesium.Color[_[r]],.6)),show:new Cesium.ShowGeometryInstanceAttribute(!0)}}))}const u=e.features.find(s=>s.properties.ID==i.properties.id),h=Cesium.Cartesian3.fromDegrees(...u.geometry.coordinates,1500);m.push(u.geometry.coordinates),A.add({text:i.properties.name,font:"bold 15px Microsoft YaHei",blendOption:Cesium.BlendOption.TRANSLUCENT,position:h,verticalOrigin:Cesium.VerticalOrigin.CENTER,horizontalOrigin:Cesium.HorizontalOrigin.LEFT})}const a=new Cesium.Primitive({releaseGeometryInstances:!1,geometryInstances:n,appearance:new Cesium.PerInstanceColorAppearance({translucent:!0,closed:!1}),asynchronous:!1});o.scene.primitives.add(a)},l=()=>{o.scene.primitives.removeAll()},p=o.scene;return new Cesium.ScreenSpaceEventHandler(p.canvas).setInputAction(t=>{const e=p.pick(t.position);if(Cesium.defined(e)&&e.id.indexOf("polygon")>-1){const n=e.id.replace(/polygon-/g,"");console.log("xxx",e.id,e),o.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(...m[n],4e4),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0},duration:2})}},Cesium.ScreenSpaceEventType.LEFT_CLICK),d(()=>{l()}),(t,e)=>{const n=x,a=R;return L(),P(a,null,{default:c(()=>[C(n,{type:"primary",onClick:E},{default:c(()=>e[0]||(e[0]=[g("\u5F00\u59CB")])),_:1}),C(n,{type:"primary",onClick:l},{default:c(()=>e[1]||(e[1]=[g("\u6E05\u9664")])),_:1})]),_:1})}}};export{k as default};
