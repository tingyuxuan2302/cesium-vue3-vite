import{_ as z}from"./OperateBox.0986405a.js";import{C as E,a as T,o as b,c as x,w as m,d as u,e as p}from"./index.fe5814f1.js";import{E as D}from"./el-button.af2fec77.js";import{g as G}from"./api.cf71c671.js";import{m as j}from"./modifyMap.01247dc3.js";import"./request.6255f877.js";import"./axios.a5b46551.js";function n(r,e){this._definitionChanged=new Cesium.Event,this.duration=r,this.image=e,this._time=performance.now()}Object.defineProperties(n.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),duration:Cesium.createPropertyDescriptor("duration")});n.prototype.getType=function(r){return"Spriteline1"};n.prototype.getValue=function(r,e){return Cesium.defined(e)||(e={}),e.image=this.image,e.time=(performance.now()-this._time)%this.duration/this.duration,e};n.prototype.equals=function(r){return this===r||r instanceof n&&this.duration===r.duration};Cesium.Material.Spriteline1Type="Spriteline1";Cesium.Material.Spriteline1Source=`
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec4 colorImage = texture(image, vec2(fract(st.s - time), st.t));
material.alpha = colorImage.a;
material.diffuse = colorImage.rgb * 1.5 ;
return material;
}
`;Cesium.Material._materialCache.addMaterial(Cesium.Material.Spriteline1Type,{fabric:{type:Cesium.Material.Spriteline1Type,uniforms:{color:new Cesium.Color(1,0,0,.5),image:"",transparent:!0,time:20},source:Cesium.Material.Spriteline1Source},translucent:function(r){return!0}});const g="/cesium-vue3-vite/json/qingdaoRoad.geojson",O={__name:"throughRoad",setup(r){const{viewer:e}=window;E(()=>{e.scene.terrainProvider=new Cesium.EllipsoidTerrainProvider({}),j({viewer:e})}),e.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120.188,36.67,2e5)});let o=null;const C=new n(1e3,"/cesium-vue3-vite/images/spriteline.png"),y=()=>{o=new Cesium.GeoJsonDataSource,o.load(g).then(function(s){const t=s.entities.values;for(let i=0;i<t.length;i++){let a=t[i];a.polyline.width=1.7,a.polyline.material=C}}),e.dataSources.add(o)};let l=null;const _=async()=>{const{res:s}=await G(g),{features:t}=s,i=[];if(t!=null&&t.length){t.forEach(w=>{w.geometry.coordinates.forEach(M=>{let c=[];M.forEach(P=>{c=c.concat(P)});const S=new Cesium.PolylineGeometry({positions:Cesium.Cartesian3.fromDegreesArray(c),width:1.7,vertexFormat:Cesium.PolylineMaterialAppearance.VERTEX_FORMAT}),I=Cesium.PolylineGeometry.createGeometry(S);i.push(new Cesium.GeometryInstance({geometry:I}))})}),console.log("-----instance-----",Cesium.Material.Spriteline1Source);let a=`czm_material czm_getMaterial(czm_materialInput materialInput)
                          {
                             czm_material material = czm_getDefaultMaterial(materialInput);
                             vec2 st = materialInput.st;
                             vec4 colorImage = texture(image, vec2(fract((st.s - speed * czm_frameNumber * 0.001)), st.t));
                             material.alpha = colorImage.a * color.a;
                             material.diffuse = colorImage.rgb * 1.5 ;
                             return material;
                          }`;const h=new Cesium.Material({fabric:{uniforms:{color:Cesium.Color.fromCssColorString("#7ffeff"),image:"/cesium-vue3-vite/images/spriteline.png",speed:10},source:a},translucent:function(){return!0}}),d=new Cesium.PolylineMaterialAppearance;d.material=h;const v=new Cesium.Primitive({geometryInstances:i,appearance:d,asynchronous:!1});l=e.scene.primitives.add(v)}},f=()=>{o&&e.dataSources.remove(o,!1),l&&e.scene.primitives.remove(l)};return T(()=>{f(),e.scene.terrainProvider=new Cesium.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"})}),(s,t)=>{const i=D,a=z;return b(),x(a,null,{default:m(()=>[u(i,{type:"primary",onClick:y},{default:m(()=>t[0]||(t[0]=[p("\u5F00\u59CB(entity\u6E32\u67D3)")])),_:1}),u(i,{type:"primary",onClick:_},{default:m(()=>t[1]||(t[1]=[p("\u5F00\u59CB(primitive\u6E32\u67D3)")])),_:1}),u(i,{type:"primary",onClick:f},{default:m(()=>t[2]||(t[2]=[p("\u6E05\u9664")])),_:1})]),_:1})}}};export{O as default};
