import{_ as E}from"./OperateBox.2bc9a4e9.js";import{u as T,y as b,a as x,o as D,c as G,w as l,d as p,e as f}from"./index.f76e180b.js";import{E as j}from"./el-button.55669a7a.js";import{g as k}from"./api.42f836e8.js";import{m as V}from"./modifyMap.f84c424e.js";import"./request.3e4b99dc.js";function o(t,i){this._definitionChanged=new Cesium.Event,this.duration=t,this.image=i,this._time=performance.now()}Object.defineProperties(o.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),duration:Cesium.createPropertyDescriptor("duration")});o.prototype.getType=function(t){return"Spriteline1"};o.prototype.getValue=function(t,i){return Cesium.defined(i)||(i={}),i.image=this.image,i.time=(performance.now()-this._time)%this.duration/this.duration,i};o.prototype.equals=function(t){return this===t||t instanceof o&&this.duration===t.duration};Cesium.Material.Spriteline1Type="Spriteline1";Cesium.Material.Spriteline1Source=`
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec4 colorImage = texture(image, vec2(fract(st.s - time), st.t));
material.alpha = colorImage.a;
material.diffuse = colorImage.rgb * 1.5 ;
return material;
}
`;Cesium.Material._materialCache.addMaterial(Cesium.Material.Spriteline1Type,{fabric:{type:Cesium.Material.Spriteline1Type,uniforms:{color:new Cesium.Color(1,0,0,.5),image:"",transparent:!0,time:20},source:Cesium.Material.Spriteline1Source},translucent:function(t){return!0}});const C="/json/qingdaoRoad.geojson",U={__name:"throughRoad",setup(t){const i=T(),{viewer:r}=i.state;b(()=>{r.scene.terrainProvider=new Cesium.EllipsoidTerrainProvider({}),V({viewer:r})}),r.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120.188,36.67,2e5)});let s=null;const _=new o(1e3,"/images/spriteline.png"),y=()=>{s=new Cesium.GeoJsonDataSource,s.load(C).then(function(m){const a=m.entities.values;for(let e=0;e<a.length;e++){let n=a[e];n.polyline.width=1.7,n.polyline.material=_}}),r.dataSources.add(s)};let c=null;const h=async()=>{const{res:m}=await k(C),{features:a}=m,e=[];if(a!=null&&a.length){a.forEach(S=>{S.geometry.coordinates.forEach(M=>{let u=[];M.forEach(z=>{u=u.concat(z)});const I=new Cesium.PolylineGeometry({positions:Cesium.Cartesian3.fromDegreesArray(u),width:1.7,vertexFormat:Cesium.PolylineMaterialAppearance.VERTEX_FORMAT}),P=Cesium.PolylineGeometry.createGeometry(I);e.push(new Cesium.GeometryInstance({geometry:P}))})}),console.log("-----instance-----",Cesium.Material.Spriteline1Source);let n=`czm_material czm_getMaterial(czm_materialInput materialInput)
                          {
                             czm_material material = czm_getDefaultMaterial(materialInput);
                             vec2 st = materialInput.st;
                             vec4 colorImage = texture(image, vec2(fract((st.s - speed * czm_frameNumber * 0.001)), st.t));
                             material.alpha = colorImage.a * color.a;
                             material.diffuse = colorImage.rgb * 1.5 ;
                             return material;
                          }`;const v=new Cesium.Material({fabric:{uniforms:{color:Cesium.Color.fromCssColorString("#7ffeff"),image:"/images/spriteline.png",speed:10},source:n},translucent:function(){return!0}}),g=new Cesium.PolylineMaterialAppearance;g.material=v;const w=new Cesium.Primitive({geometryInstances:e,appearance:g,asynchronous:!1});c=r.scene.primitives.add(w)}},d=()=>{s&&r.dataSources.remove(s,!1),c&&r.scene.primitives.remove(c)};return x(()=>{d(),r.scene.terrainProvider=new Cesium.CesiumTerrainProvider({url:"http://data.marsgis.cn/terrain"})}),(m,a)=>{const e=j,n=E;return D(),G(n,null,{default:l(()=>[p(e,{type:"primary",onClick:y},{default:l(()=>[f("\u5F00\u59CB(entity\u6E32\u67D3)")]),_:1}),p(e,{type:"primary",onClick:h},{default:l(()=>[f("\u5F00\u59CB(primitive\u6E32\u67D3)")]),_:1}),p(e,{type:"primary",onClick:d},{default:l(()=>[f("\u6E05\u9664")]),_:1})]),_:1})}}};export{U as default};
